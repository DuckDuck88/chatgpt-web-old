<!DOCTYPE html>
<html lang="en">

<!--自适应屏幕大小-->
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<head>
    <!-- <link rel="shortcut icon" href="" type="image/x-icon" /> -->
    <meta charset="UTF-8">
    <title>ChatGPT</title>
    <style>
        body {
            color: #123;
            background-color: #eee;
        }

        @media (prefers-color-scheme: dark) {
            body {
                background: black;
                color: white;
            }
        }
    </style>
</head>

<body>
<div align="center">
    <h2>ChatGPT</h2>
    <div>注意：</div>
    <div>1. 请勿重复提交</div>
    <div>2. 接口返回有长度限制</div>
    <hr/>
    {% if message %} {{ message }} {% endif %}
    <form method="post" onsubmit="submit.disabled=true">
        <textarea style="width:35%;" name="question" placeholder="点击这里输入问题" rows="11" id="form"></textarea>
        <br>
        <input type="submit" style="width:150px;height:60px;background-color:blue;font-size:40px" value="询问"
               id="submit"/>
    </form>
    <div id="loading" style="display:none; color:red"><b>小机的 CPU 正在疯狂转动，请稍等...</b></div>
    {% if question %}
        <div style="text-align: left"><b>You:</b>
            <pre id="question">{{ question }}</pre>
        </div>
        <hr/>
        <div style="text-align: left"><b>AI:</b>
            <pre style="text-align:left; white-space: pre-wrap;" id="res">{{ res }}</pre>
        </div>
    {% endif %}
</div>
<!-- 历史记录 -->
<div style="position: absolute;right: 0px; width: 30%; height: 100%;">
    <h3>历史消息</h3>
    <div style="width:100%; max-height:70%; overflow-y: auto;">
          {% for history in web_history %}
              <p>{{ history }}</p>
          {% endfor %}
    </div>
</div>
</body>
<script>
    let loading = document.getElementById('loading');
    let form = document.querySelector('form');
    form.addEventListener('submit', () => {
        loading.style.display = 'block';
    });
</script>
</html>